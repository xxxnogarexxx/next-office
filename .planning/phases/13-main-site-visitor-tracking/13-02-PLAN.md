---
phase: 13-main-site-visitor-tracking
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/lib/conversions/google-ads.ts
autonomous: true
requirements:
  - CAP-03 (extended)
  - CAP-04 (extended)

must_haves:
  truths:
    - "google-ads.ts uploadConversion() dead code is documented or removed"
    - "No runtime regressions — no src file imports from google-ads.ts"
  artifacts:
    - path: "src/lib/conversions/google-ads.ts"
      provides: "Clean file — either deleted or annotated as reference-only"
  key_links: []
---

<objective>
Remove or clearly document the dead `uploadConversion()` function in `src/lib/conversions/google-ads.ts`.

Purpose: This module is never imported by any source file. The actual upload logic is duplicated in the Supabase Edge Function (Deno) queue processor, as decided in Phase 10-03 (see STATE.md: "Upload logic duplicated from google-ads.ts for Deno Edge Function — cannot import from Next.js app, two modules must stay in sync"). Keeping unexplained dead code creates confusion about which module is authoritative.

Output: `google-ads.ts` either deleted or clearly annotated as a reference implementation for the Deno Edge Function.
</objective>

<execution_context>
@/Users/szymonwilkosz/.claude/get-shit-done/workflows/execute-plan.md
@/Users/szymonwilkosz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md

<interfaces>
<!-- Executor context: no file in src/ imports google-ads.ts -->

Verification that google-ads.ts is dead code:
```bash
# This returns zero matches — no file imports from google-ads
grep -r "from.*google-ads\|import.*google-ads" src/
```

From STATE.md accumulated decisions:
- "Upload logic duplicated from google-ads.ts for Deno Edge Function — cannot import from Next.js app, two modules must stay in sync"
- The queue processor Edge Function is the REAL upload path. google-ads.ts was the original implementation, then duplicated to Deno.
</interfaces>
</context>

<tasks>

<task type="auto">
  <name>Task 1: Annotate google-ads.ts as reference implementation</name>
  <files>src/lib/conversions/google-ads.ts</files>
  <action>
Add a prominent JSDoc banner at the top of the file (replacing the existing module comment) that clearly marks this as a **reference implementation** that is NOT imported by any runtime code.

Replace the existing module comment (lines 1-14) with:

```typescript
/**
 * Google Ads API Offline Conversion Upload — REFERENCE IMPLEMENTATION
 *
 * ⚠️  THIS MODULE IS NOT IMPORTED BY ANY RUNTIME CODE.
 *
 * The actual upload runs in a Supabase Edge Function (Deno) that duplicates
 * this logic. The two modules must stay in sync. See:
 * - Queue processor: supabase/functions/process-conversion-queue/index.ts
 * - Decision: "Upload logic duplicated from google-ads.ts for Deno Edge Function
 *   — cannot import from Next.js app, two modules must stay in sync"
 *   (Phase 10-03, STATE.md)
 *
 * This file is kept as the canonical reference for:
 * - OAuth2 token refresh flow
 * - uploadClickConversions payload structure (gclid, userIdentifiers, consent)
 * - Conversion action resource name mapping
 *
 * If updating upload logic, update BOTH this file and the Edge Function.
 */
```

Do NOT delete the file — it serves as the authoritative reference for the Edge Function implementation. Deleting it would remove the only documented source of the upload payload structure in the main codebase.

Do NOT change any of the actual code — only the top-level module comment.
  </action>
  <verify>
    <automated>head -5 src/lib/conversions/google-ads.ts | grep -c "REFERENCE IMPLEMENTATION"</automated>
  </verify>
  <done>
- google-ads.ts has a clear REFERENCE IMPLEMENTATION banner
- Warning that module is not imported by any runtime code
- Cross-reference to the Supabase Edge Function that contains the actual runtime code
- Instruction to update both files when changing upload logic
  </done>
</task>

</tasks>

<verification>
1. `head -5 src/lib/conversions/google-ads.ts` — shows REFERENCE IMPLEMENTATION banner
2. `grep -r "from.*google-ads\|import.*google-ads" src/` — still zero matches (no runtime imports)
3. `npx tsc --noEmit` — no type errors
</verification>

<success_criteria>
- google-ads.ts module comment clearly identifies the file as a reference implementation
- The warning about no runtime imports is visible in the first 5 lines
- Cross-reference to the Edge Function queue processor is documented
- No code changes — only documentation update
</success_criteria>

<output>
After completion, create `.planning/phases/13-main-site-visitor-tracking/13-02-SUMMARY.md`
</output>
