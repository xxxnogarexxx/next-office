---
phase: 06-seo-and-analytics
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/(main)/page.tsx
  - src/app/sitemap.ts
  - src/app/robots.ts
  - src/app/(main)/ueber-uns/page.tsx
  - src/app/(main)/fuer-anbieter/page.tsx
  - src/app/(main)/impressum/page.tsx
  - src/app/(main)/datenschutz/page.tsx
  - src/app/(main)/agb/page.tsx
autonomous: true
requirements:
  - SEO-02
  - SEO-03
  - SEO-04
  - SEO-06
  - SEO-08
  - SEO-09
  - QW-04

must_haves:
  truths:
    - "Sharing homepage on LinkedIn/Slack shows correct OG image, title, and description"
    - "Homepage includes Organization JSON-LD structured data — passes Google Rich Results Test"
    - "Sharing ueber-uns and fuer-anbieter pages shows specific OG tags — not generic root defaults"
    - "/contact URL is present in sitemap.xml"
    - "robots.txt disallows /api/ and /lp/ paths"
    - "Legal pages (impressum, datenschutz, agb) have canonical URLs set"
    - "Homepage has explicit page-level metadata export"
  artifacts:
    - path: "src/app/(main)/page.tsx"
      provides: "Homepage metadata export with OG tags and Organization JSON-LD"
      contains: "export const metadata"
    - path: "src/app/robots.ts"
      provides: "Robots blocking /api/ and /lp/"
      contains: "disallow"
    - path: "src/app/sitemap.ts"
      provides: "Contact page in sitemap"
      contains: "/contact"
  key_links:
    - from: "src/app/(main)/page.tsx"
      to: "/hero-office.jpg"
      via: "openGraph.images reference"
      pattern: "hero-office"
    - from: "src/app/(main)/page.tsx"
      to: "Organization JSON-LD"
      via: "script type=application/ld+json"
      pattern: "Organization"
---

<objective>
Set correct metadata and OG tags on all public pages, add Organization structured data to homepage, fix robots.txt to block /api/ and /lp/, add /contact to sitemap, and add canonical URLs to legal pages.

Purpose: Social sharing currently shows no OG image (no default image reference). Homepage has no explicit metadata export and no Organization schema. robots.txt allows crawling API endpoints and LP routes. /contact is missing from sitemap. Legal pages lack canonical URLs.

Output: Every main site page has correct social preview metadata, homepage has Organization schema, robots blocks non-public paths, sitemap is complete, legal pages have canonicals.
</objective>

<execution_context>
@/Users/szymonwilkosz/.claude/get-shit-done/workflows/execute-plan.md
@/Users/szymonwilkosz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

<interfaces>
<!-- Root layout already has metadataBase set, so OG image paths are resolved relative to it -->

From src/app/layout.tsx (root metadata):
```typescript
export const metadata: Metadata = {
  metadataBase: new URL("https://next-office.io"),
  title: { default: "Büro mieten – ...", template: "%s | NextOffice" },
  description: "Finden Sie flexible Büros...",
  openGraph: { type: "website", locale: "de_DE", url: SITE_URL, siteName: "NextOffice", ... },
  // NO images in openGraph — this is the gap
};
```

From src/app/(main)/page.tsx (current):
```typescript
// NO metadata export — inherits everything from root
// NO JSON-LD structured data
export default function HomePage() {
  return (
    <>
      {/* Hero */}
      ...
    </>
  );
}
```

From src/app/(main)/ueber-uns/page.tsx (current metadata):
```typescript
export const metadata: Metadata = {
  title: "Über uns – NextOffice",
  description: "Seit 2017 helfen wir...",
  alternates: { canonical: "https://next-office.io/ueber-uns" },
  // NO openGraph — inherits root default (which also has no image)
};
```

From src/app/(main)/fuer-anbieter/page.tsx (current metadata):
```typescript
export const metadata: Metadata = {
  title: "Für Anbieter – NextOffice",
  description: "Listen Sie Ihre Büroflächen...",
  alternates: { canonical: "https://next-office.io/fuer-anbieter" },
  // NO openGraph — same gap
};
```

From src/app/sitemap.ts (current):
```typescript
// staticPages: homepage, /search, /blog, /ueber-uns, /fuer-anbieter
// MISSING: /contact
```

From src/app/robots.ts (current):
```typescript
// Allows everything: { userAgent: "*", allow: "/" }
// MISSING: disallow for /api/ and /lp/
```

From legal pages (impressum, datenschutz, agb):
```typescript
// All have: robots: { index: false, follow: true }
// All MISSING: alternates.canonical
```
</interfaces>
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add homepage metadata with OG tags, Organization schema, fix robots and sitemap</name>
  <files>src/app/(main)/page.tsx, src/app/sitemap.ts, src/app/robots.ts</files>
  <action>
1. In `src/app/(main)/page.tsx`:
   - Add `import type { Metadata } from "next";` at the top of the file (after existing imports)
   - Add an explicit metadata export BEFORE the component function:
     ```typescript
     const SITE_URL = "https://next-office.io";

     export const metadata: Metadata = {
       title: "Büro mieten – Flexible Office Spaces in Deutschland | NextOffice",
       description: "Finden Sie flexible Büros und Office Spaces in Berlin, München, Hamburg und Frankfurt. Kostenlose Beratung, beste Preise garantiert.",
       openGraph: {
         title: "Büro mieten – Flexible Office Spaces in Deutschland | NextOffice",
         description: "Finden Sie flexible Büros und Office Spaces in Berlin, München, Hamburg und Frankfurt. Kostenlose Beratung, beste Preise garantiert.",
         type: "website",
         url: SITE_URL,
         images: [{ url: "/hero-office.jpg", width: 1200, height: 630, alt: "NextOffice – Flexible Büros in Deutschland" }],
       },
       twitter: {
         card: "summary_large_image",
         title: "Büro mieten – Flexible Office Spaces in Deutschland | NextOffice",
         description: "Finden Sie flexible Büros und Office Spaces in Berlin, München, Hamburg und Frankfurt.",
         images: ["/hero-office.jpg"],
       },
       alternates: {
         canonical: SITE_URL,
       },
     };
     ```
   - Use `/hero-office.jpg` as the OG image — it already exists in public/, is a professional office photo, and metadataBase resolves it to the absolute URL `https://next-office.io/hero-office.jpg`.
   - Add Organization JSON-LD structured data inside the component, as the first child of the fragment (`<>`), BEFORE the `{/* Hero */}` comment:
     ```tsx
     <script
       type="application/ld+json"
       dangerouslySetInnerHTML={{
         __html: JSON.stringify({
           "@context": "https://schema.org",
           "@type": "Organization",
           name: "NextOffice",
           url: "https://next-office.io",
           logo: "https://next-office.io/next.svg",
           description: "Deutschlands Plattform für flexible Büros und Office Spaces. Kostenlose Beratung, beste Konditionen.",
           address: {
             "@type": "PostalAddress",
             addressCountry: "DE",
           },
           contactPoint: {
             "@type": "ContactPoint",
             telephone: "+49-30-200042000",
             contactType: "customer service",
             email: "anfrage@next-office.io",
             availableLanguage: "German",
           },
           sameAs: [],
         }).replace(/</g, "\\u003c"),
       }}
     />
     ```

2. In `src/app/sitemap.ts`:
   - Add `/contact` to the staticPages array, after the `/fuer-anbieter` entry:
     ```typescript
     {
       url: `${SITE_URL}/contact`,
       lastModified: now,
       changeFrequency: "monthly" as const,
       priority: 0.7,
     },
     ```

3. In `src/app/robots.ts`:
   - Update the rules to include disallow directives for /api/ and /lp/:
     ```typescript
     export default function robots(): MetadataRoute.Robots {
       return {
         rules: {
           userAgent: "*",
           allow: "/",
           disallow: ["/api/", "/lp/"],
         },
         sitemap: "https://next-office.io/sitemap.xml",
       };
     }
     ```
  </action>
  <verify>
    <automated>cd /Users/szymonwilkosz/Library/Mobile\ Documents/com~apple~CloudDocs/claude-config/projects/next-office && grep -q "export const metadata" src/app/\(main\)/page.tsx && grep -q "Organization" src/app/\(main\)/page.tsx && grep -q "/contact" src/app/sitemap.ts && grep -q "disallow" src/app/robots.ts && echo "PASS" || echo "FAIL"</automated>
  </verify>
  <done>Homepage has explicit metadata with OG image and Organization JSON-LD. /contact in sitemap. robots.txt blocks /api/ and /lp/.</done>
</task>

<task type="auto">
  <name>Task 2: Add OG tags to ueber-uns/fuer-anbieter and canonical URLs to legal pages</name>
  <files>src/app/(main)/ueber-uns/page.tsx, src/app/(main)/fuer-anbieter/page.tsx, src/app/(main)/impressum/page.tsx, src/app/(main)/datenschutz/page.tsx, src/app/(main)/agb/page.tsx</files>
  <action>
1. In `src/app/(main)/ueber-uns/page.tsx`:
   - Replace the existing metadata export with one that includes openGraph and twitter:
     ```typescript
     export const metadata: Metadata = {
       title: "Über uns – NextOffice",
       description: "Seit 2017 helfen wir Unternehmen in ganz Deutschland, das passende Büro zu finden. Kostenlos, persönlich und unverbindlich. Erfahren Sie mehr über NextOffice.",
       openGraph: {
         title: "Über uns – NextOffice",
         description: "Seit 2017 helfen wir Unternehmen in ganz Deutschland, das passende Büro zu finden.",
         type: "website",
         url: "https://next-office.io/ueber-uns",
         images: [{ url: "/hero-office.jpg", width: 1200, height: 630, alt: "NextOffice Team" }],
       },
       twitter: {
         card: "summary_large_image",
         title: "Über uns – NextOffice",
         description: "Seit 2017 helfen wir Unternehmen in ganz Deutschland, das passende Büro zu finden.",
         images: ["/hero-office.jpg"],
       },
       alternates: {
         canonical: "https://next-office.io/ueber-uns",
       },
     };
     ```

2. In `src/app/(main)/fuer-anbieter/page.tsx`:
   - Replace the existing metadata export with one that includes openGraph and twitter:
     ```typescript
     export const metadata: Metadata = {
       title: "Für Anbieter – NextOffice",
       description: "Listen Sie Ihre Büroflächen kostenlos auf NextOffice. Erreichen Sie Unternehmen, die aktiv nach flexiblen Büros suchen — ohne Vorabkosten.",
       openGraph: {
         title: "Für Anbieter – NextOffice",
         description: "Listen Sie Ihre Büroflächen kostenlos auf NextOffice. Erreichen Sie Unternehmen, die aktiv nach flexiblen Büros suchen.",
         type: "website",
         url: "https://next-office.io/fuer-anbieter",
         images: [{ url: "/hero-office.jpg", width: 1200, height: 630, alt: "Büroflächen auf NextOffice listen" }],
       },
       twitter: {
         card: "summary_large_image",
         title: "Für Anbieter – NextOffice",
         description: "Listen Sie Ihre Büroflächen kostenlos auf NextOffice.",
         images: ["/hero-office.jpg"],
       },
       alternates: {
         canonical: "https://next-office.io/fuer-anbieter",
       },
     };
     ```

3. In `src/app/(main)/impressum/page.tsx`:
   - Add `alternates` to the existing metadata:
     ```typescript
     export const metadata: Metadata = {
       title: "Impressum",
       robots: { index: false, follow: true },
       alternates: {
         canonical: "https://next-office.io/impressum",
       },
     };
     ```

4. In `src/app/(main)/datenschutz/page.tsx`:
   - Add `alternates` to the existing metadata:
     ```typescript
     export const metadata: Metadata = {
       title: "Datenschutzerklärung",
       robots: { index: false, follow: true },
       alternates: {
         canonical: "https://next-office.io/datenschutz",
       },
     };
     ```

5. In `src/app/(main)/agb/page.tsx`:
   - Add `alternates` to the existing metadata:
     ```typescript
     export const metadata: Metadata = {
       title: "Allgemeine Geschäftsbedingungen",
       robots: { index: false, follow: true },
       alternates: {
         canonical: "https://next-office.io/agb",
       },
     };
     ```
  </action>
  <verify>
    <automated>cd /Users/szymonwilkosz/Library/Mobile\ Documents/com~apple~CloudDocs/claude-config/projects/next-office && grep -q "openGraph" src/app/\(main\)/ueber-uns/page.tsx && grep -q "openGraph" src/app/\(main\)/fuer-anbieter/page.tsx && grep -q "canonical" src/app/\(main\)/impressum/page.tsx && grep -q "canonical" src/app/\(main\)/datenschutz/page.tsx && grep -q "canonical" src/app/\(main\)/agb/page.tsx && echo "PASS" || echo "FAIL"</automated>
  </verify>
  <done>ueber-uns and fuer-anbieter pages have full OG tags for social previews. All three legal pages have canonical URLs.</done>
</task>

</tasks>

<verification>
1. `grep "export const metadata" src/app/(main)/page.tsx` — homepage has explicit metadata
2. `grep "Organization" src/app/(main)/page.tsx` — homepage has Organization JSON-LD
3. `grep "openGraph" src/app/(main)/ueber-uns/page.tsx` — ueber-uns has OG tags
4. `grep "openGraph" src/app/(main)/fuer-anbieter/page.tsx` — fuer-anbieter has OG tags
5. `grep "/contact" src/app/sitemap.ts` — contact page in sitemap
6. `grep "disallow" src/app/robots.ts` — robots blocks /api/ and /lp/
7. `grep "canonical" src/app/(main)/impressum/page.tsx` — legal page has canonical
8. `npx tsc --noEmit` — TypeScript compiles without errors
</verification>

<success_criteria>
- Homepage exports explicit metadata with OG image reference and Organization JSON-LD
- ueber-uns and fuer-anbieter pages include openGraph and twitter metadata
- /contact URL appears in sitemap output
- robots.txt includes disallow rules for /api/ and /lp/
- impressum, datenschutz, agb pages have canonical URL alternates
- All files compile without TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/06-seo-and-analytics/06-02-SUMMARY.md`
</output>
